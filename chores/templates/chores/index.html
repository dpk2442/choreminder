{% extends "chores/base.html" %}
{% load chores_filters %}
{% block content %}

{% if tag_form.has_tags %}
<form method="get" action="">
    {{ tag_form.tag }}
    <input type="submit" value="Filter">
</form>
{% endif %}

{% for group_name, chores in chore_groups.items %}
<details{% if forloop.counter == 1 %} open{% endif %}>
    <summary><h2>{{ group_name }}</h2></summary>
    {% if chores %}
    <ul>
        {% for chore in chores %}
        <li>
            <h3>{{ chore.name }}</h3>
            {% if chore.tags %}
            <ul>
                {% for tag in chore.tags %}
                <li>{{ tag.name }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            <p>{{ chore.description }}</p>
            <form action="{% url "chores:log_chore" chore.id %}" method="POST">
                {% csrf_token %}
                <input type="submit" value="Mark Done">
            </form>
            <p>
                Next Due: {{ chore.status.next_due | default:"" }}
                |
                <a href="{% url "chores:edit_chore" chore.id %}">Edit</a>
                <a href="{% url "chores:delete_chore" chore.id %}">Delete</a>
            </p>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No chores to display.</p>
    {% endif %}
</details>
{% empty %}
<p>No chores to display.</p>
{% endfor %}

<p>
    <a href="{% url "chores:add_chore" %}">Add Chore</a>
</p>
{% endblock %}
